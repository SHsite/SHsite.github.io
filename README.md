# SHsite.github.io
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÌåÄÌö®Í≥ºÏÑ± ÏßÑÎã® Î¶¨Ìè¨Ìä∏ ÏûêÎèôÌôî ÏãúÏä§ÌÖú</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Malgun Gothic', 'ÎßëÏùÄ Í≥†Îîï', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
            font-weight: 700;
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }
        
        .input-section, .report-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .section-title {
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 1.8em;
            font-weight: 600;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .file-upload {
            border: 2px dashed #3498db;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .file-upload:hover {
            background: #e3f2fd;
            border-color: #2196f3;
        }
        
        .file-upload input {
            display: none;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }
        
        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .report-content {
            display: none;
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .company-info h2 {
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .company-info p {
            color: #7f8c8d;
        }
        
        .logo-container {
            max-width: 150px;
            max-height: 80px;
        }
        
        .logo-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 5px;
        }
        
        .stat-card p {
            opacity: 0.9;
        }
        
        .chart-container {
            margin: 30px 0;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .findings {
            background: #f8f9fa;
            border-left: 5px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }
        
        .findings h4 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .findings ul {
            list-style: none;
            padding-left: 0;
        }
        
        .findings li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }
        
        .findings li:before {
            content: "‚ñ∂";
            color: #3498db;
            position: absolute;
            left: 0;
        }
        
        .factor-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .factor-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-top: 4px solid;
        }
        
        .factor-card.direction { border-top-color: #e74c3c; }
        .factor-card.relationship { border-top-color: #f39c12; }
        .factor-card.execution { border-top-color: #27ae60; }
        .factor-card.arrangement { border-top-color: #3498db; }
        .factor-card.management { border-top-color: #9b59b6; }
        .factor-card.agility { border-top-color: #1abc9c; }
        
        .factor-card h4 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .score-display {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .gap-display {
            font-size: 0.9em;
            color: #7f8c8d;
        }
        
        .subjective-responses {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }
        
        .response-category {
            margin-bottom: 25px;
        }
        
        .response-category h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #3498db;
        }
        
        .response-list {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
        }
        
        .response-item {
            margin-bottom: 10px;
            padding: 8px 12px;
            background: #f1f3f4;
            border-radius: 8px;
            font-size: 0.95em;
        }
        
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .input-section {
                display: none;
            }
            
            .report-content {
                display: block !important;
            }
            
            .btn-group {
                display: none;
            }
            
            .chart-container {
                page-break-inside: avoid;
            }
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ÌåÄÌö®Í≥ºÏÑ± ÏßÑÎã® Î¶¨Ìè¨Ìä∏ ÏûêÎèôÌôî ÏãúÏä§ÌÖú</h1>
            <p>DREAM+A Î™®Îç∏ Í∏∞Î∞ò ÌåÄÌö®Í≥ºÏÑ± ÏßÑÎã® Î∞è Î¶¨Ìè¨Ìä∏ ÏÉùÏÑ±</p>
        </div>

        <!-- Input Section -->
        <div class="input-section" id="inputSection">
            <h2 class="section-title">üìä ÏßÑÎã® Ï†ïÎ≥¥ ÏûÖÎ†•</h2>
            
            <div class="form-group">
                <label for="companyName">ÌöåÏÇ¨Î™Ö</label>
                <input type="text" id="companyName" placeholder="Ïòà: ÏÑúÏö∏ÎåÄÌïôÍµêÎ≥ëÏõê Í±¥Í∞ïÏ¶ùÏßÑÏÑºÌÑ∞">
            </div>
            
            <div class="form-group">
                <label for="teamName">ÌåÄ/Î∂ÄÏÑúÎ™Ö</label>
                <input type="text" id="teamName" placeholder="Ïòà: Í±¥Í∞ïÏ¶ùÏßÑÏÑºÌÑ∞">
            </div>
            
            <div class="form-group">
                <label for="reportDate">ÏßÑÎã®ÏùºÏûê</label>
                <input type="date" id="reportDate">
            </div>
            
            <div class="form-group">
                <label for="totalMembers">Ï†ÑÏ≤¥ Ïù∏Ïõê</label>
                <input type="number" id="totalMembers" placeholder="36" min="1">
            </div>
            
            <div class="form-group">
                <label for="leaderCount">ÌåÄÏû• Ïàò</label>
                <input type="number" id="leaderCount" placeholder="1" min="1">
            </div>
            
            <div class="form-group">
                <label for="logoUpload">ÌöåÏÇ¨ Î°úÍ≥†</label>
                <div class="file-upload" onclick="document.getElementById('logoFile').click()">
                    <input type="file" id="logoFile" accept="image/*">
                    <p>ÌÅ¥Î¶≠ÌïòÏó¨ Î°úÍ≥† Ïù¥ÎØ∏ÏßÄÎ•º ÏóÖÎ°úÎìúÌïòÏÑ∏Ïöî</p>
                    <small>PNG, JPG, GIF ÌòïÏãù ÏßÄÏõê</small>
                </div>
            </div>
            
            <div class="form-group">
                <label for="csvUpload">ÏÑ§Î¨∏ Îç∞Ïù¥ÌÑ∞ (CSV)</label>
                <div class="file-upload" onclick="document.getElementById('csvFile').click()">
                    <input type="file" id="csvFile" accept=".csv">
                    <p>ÌÅ¥Î¶≠ÌïòÏó¨ CSV ÌååÏùºÏùÑ ÏóÖÎ°úÎìúÌïòÏÑ∏Ïöî</p>
                    <small>Í∏∞Ï°¥ ÏñëÏãùÍ≥º ÎèôÏùºÌïú Íµ¨Ï°∞Ïùò CSV ÌååÏùº</small>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn" onclick="generateReport()">üìà Î¶¨Ìè¨Ìä∏ ÏÉùÏÑ±</button>
                <button class="btn" onclick="loadSampleData()" style="background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);">üìã ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ Î°úÎìú</button>
            </div>
        </div>

        <!-- Report Section -->
        <div class="report-section" id="reportSection">
            <div class="report-content" id="reportContent">
                <!-- Î¶¨Ìè¨Ìä∏ ÎÇ¥Ïö©Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
            </div>
            
            <div class="btn-group">
                <button class="btn" onclick="printReport()">üñ®Ô∏è Ïù∏ÏáÑ/PDF</button>
                <button class="btn" onclick="showInputSection()" style="background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);">üìù ÏÉà Î¶¨Ìè¨Ìä∏ ÏûëÏÑ±</button>
            </div>
        </div>
    </div>

    <script>
        // DREAM+A Î™®Îç∏ Ï†ïÏùò
        const dreamModel = {
            factors: {
                'D': { 
                    name: 'Î™ÖÌôïÌïú Î∞©Ìñ•ÏÑ±', 
                    color: '#e74c3c',
                    subfactors: [
                        { key: 'direction_understanding', name: 'ÌåÄ Î™©Ìëú/Î∞©Ìñ•ÏÑ± Ïù∏ÏßÄ Î∞è Ïù¥Ìï¥', items: [1, 7, 13] },
                        { key: 'direction_alignment', name: 'ÌåÄ Î™©Ìëú/Î∞©Ìñ•ÏÑ± Ï†ïÎ†¨', items: [19, 25, 31] }
                    ]
                },
                'R': { 
                    name: 'Í∏çÏ†ïÏ†Å Í¥ÄÍ≥Ñ', 
                    color: '#f39c12',
                    subfactors: [
                        { key: 'emotional_trust', name: 'Ï†ïÏÑúÏ†Å Ïã†Î¢∞Í¥ÄÍ≥Ñ', items: [2, 8, 14, 32] },
                        { key: 'open_communication', name: 'Í∞úÎ∞©Ï†Å ÏÜåÌÜµ', items: [20, 26] }
                    ]
                },
                'E': { 
                    name: 'ÌåÄÏúºÎ°úÏÑú Ïã§Ìñâ', 
                    color: '#27ae60',
                    subfactors: [
                        { key: 'knowledge_sharing', name: 'ÏßÄÏãù/Í∏∞Ïà† Í≥µÏú†Î•º ÌÜµÌïú ÏÑ±Ïû•', items: [3, 9, 15, 21, 27, 33] },
                        { key: 'constructive_feedback', name: 'Í±¥ÏÑ§Ï†Å Î¨∏Ï†úÏ†úÍ∏∞ÏôÄ ÌîºÎìúÎ∞±', items: [] }
                    ]
                },
                'A': { 
                    name: 'ÌåÄ Ïó≠Ìï† Ï†ïÎ†¨', 
                    color: '#3498db',
                    subfactors: [
                        { key: 'effective_role_distribution', name: 'Ìö®Í≥ºÏ†ÅÏù∏ Ïó≠Ìï† Î∞∞Î∂Ñ', items: [4, 10, 16, 22, 28, 34] },
                        { key: 'mutual_role_understanding', name: 'ÏÉÅÌò∏ Ïó≠Ìï† Ïù¥Ìï¥ Î∞è Ï°∞Ï†ï', items: [] }
                    ]
                },
                'M': { 
                    name: 'ÌåÄ ÏóÖÎ¨¥ Í¥ÄÎ¶¨', 
                    color: '#9b59b6',
                    subfactors: [
                        { key: 'performance_facilitation', name: 'Ïã§ÌñâÏùÑ Ï¥âÏßÑÌïòÎäî ÏàòÌñâÍ¥ÄÎ¶¨', items: [5, 11, 17, 23, 29, 35] },
                        { key: 'process_recognition', name: 'Í≥ºÏ†ï Î∞è Í≤∞Í≥ºÏóê ÎåÄÌïú Ïù∏Ï†ï', items: [] }
                    ]
                },
                '+A': { 
                    name: 'ÌåÄ ÎØºÏ≤©ÏÑ±', 
                    color: '#1abc9c',
                    subfactors: [
                        { key: 'situational_awareness', name: 'ÏÉÅÏãúÍ≤ΩÍ≥Ñ', items: [6] },
                        { key: 'speed', name: 'Ïã†ÏÜçÏÑ±', items: [12, 18, 24] },
                        { key: 'flexibility', name: 'Ïú†Ïó∞ÏÑ±', items: [30, 36] }
                    ]
                }
            }
        };

        let surveyData = null;
        let companyLogo = null;

        // ÌååÏùº ÏóÖÎ°úÎìú Ìï∏Îì§Îü¨
        document.getElementById('logoFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    companyLogo = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        });

        document.getElementById('csvFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                Papa.parse(file, {
                    header: true,
                    skipEmptyLines: true,
                    complete: function(results) {
                        surveyData = results.data;
                        console.log('CSV Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏôÑÎ£å:', surveyData.length, 'Í∞ú ÏùëÎãµ');
                    },
                    error: function(error) {
                        alert('CSV ÌååÏùº ÏùΩÍ∏∞ Ïò§Î•ò: ' + error.message);
                    }
                });
            }
        });

        // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        function loadSampleData() {
            document.getElementById('companyName').value = 'ÏÑúÏö∏ÎåÄÌïôÍµêÎ≥ëÏõê';
            document.getElementById('teamName').value = 'Í±¥Í∞ïÏ¶ùÏßÑÏÑºÌÑ∞';
            document.getElementById('reportDate').value = '2023-05-02';
            document.getElementById('totalMembers').value = '36';
            document.getElementById('leaderCount').value = '1';
            
            // ÏÉòÌîå CSV Îç∞Ïù¥ÌÑ∞ ÌååÏã± (Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞)
            const sampleCsvData = `ÏùëÎãµÏûêID,Í∑ÄÌïòÏùò ÏßÅÏ±ÖÏùÑ ÏÑ†ÌÉùÌï¥ Ï£ºÏÑ∏Ïöî,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÌåÄÏùò ÎØ∏ÏÖòÍ≥º Î™©ÌëúÎ•º Î™ÖÌôïÌûà Ïù¥Ìï¥ÌïòÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÎèôÎ£åÏùò Í≤ΩÌóò ÏùòÍ≤¨ ÏÑ±Ìñ• Ï∞®Ïù¥Î•º Ïù∏Ï†ïÌïòÍ≥† Ïª§ÎÆ§ÎãàÏºÄÏù¥ÏÖò ÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÏÉàÎ°≠Í≤å ÌïôÏäµÌïú ÏßÄÏãù/Í∏∞Ïà†ÏùÑ Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú Í≥µÏú†ÌïúÎã§,Ïö∞Î¶¨ ÌåÄÏùÄ Íµ¨ÏÑ±ÏõêÏùò Ïó≠ÎüâÍ≥º Í∞úÏù∏Ïùò ÎãàÏ¶àÎ•º Í≥†Î†§Ìï¥ ÏóÖÎ¨¥Í∞Ä Î∞∞Î∂ÑÎêòÏñ¥ ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏùò Íµ¨ÏÑ±ÏõêÎì§ÏùÄ ÏóÖÎ¨¥ Î™©Ìëú ÏàòÎ¶Ω Ïãú Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú Ï∞∏Ïó¨ÌïòÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÏùòÎ£åÌôòÍ≤ΩÏù¥ÎÇò Í≥†Í∞ùÏùò ÏöîÍµ¨ Î∞è Î≥ÄÌôîÎ•º ÏòàÏùò Ï£ºÏãúÌïòÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÌåÄ Î™©ÌëúÍ∞Ä Ï°∞ÏßÅÏùò ÎπÑÏ†Ñ Ï†ÑÎûµÍ≥º Ïó∞Í≥ÑÎêòÏñ¥ ÏûàÏùåÏùÑ Î™ÖÌôïÌûà Ïù∏ÏãùÌïòÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÎèôÎ£åÏùò ÏóÖÎ¨¥ Ïô∏Ï†ÅÏù∏ Î∂ÄÎ∂ÑÏóê ÎåÄÌï¥ÏÑúÎèÑ Í¥ÄÏã¨ÏùÑ Í∞ñÍ≥† Î∞∞Î†§ÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÏóÖÎ¨¥ ÏàòÌñâÏóê ÏöîÍµ¨ÎêòÎäî Ï†ïÎ≥¥ Îì±Ïùò Î¶¨ÏÜåÏä§Î•º Ï∂©Î∂ÑÌûà Í≥µÏú†ÌïòÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏùÄ ÏóÖÎ¨¥ Í∞Ñ Ïó∞Í≥ÑÏÑ±ÏùÑ Í≥†Î†§ÌïòÏó¨ Ïú†Í∏∞Ï†ÅÏúºÎ°ú Îã¥Îãπ ÏóÖÎ¨¥Î•º Ï°∞Ï†ïÌïòÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ Í∞ÅÏûêÏùò Î™©ÌëúÎ•º Îã¨ÏÑ±ÌïòÍ∏∞ ÏúÑÌïú Íµ¨Ï≤¥Ï†ÅÏù∏ Ïã§ÌñâÍ≥ÑÌöçÏùÑ Í∞ÄÏßÄÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ Îπ†Î•∏ ÌôòÍ≤Ω Î≥ÄÌôî ÏÜçÏóêÏÑú ÏÉàÎ°úÏö¥ ÏßÄÏãùÍ≥º Í∏∞Ïà† Îì±Ïóê ÎåÄÌï¥ Ïù∏ÏßÄÌïòÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÏûêÏã†Ïùò ÏóÖÎ¨¥Í∞Ä ÌåÄÏùò Î™©Ìëú Îã¨ÏÑ±Ïóê Í∏∞Ïó¨ÌïòÍ≥† ÏûàÏùåÏùÑ Î™ÖÌôïÌïòÍ≤å Ïù∏ÏãùÌïòÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÎèôÎ£åÏùò ÎßêÍ≥º ÌñâÎèôÏùÑ ÎØøÍ≥† Ï°¥Ï§ëÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÏóÖÎ¨¥Í∞Ä ÎßàÎ¨¥Î¶¨ ÎêòÏóàÏùÑ Îïå ÏàòÌñâÍ≥ºÏ†ïÍ≥º Í≤∞Í≥ºÎ•º Î≥µÍ∏∞ÌïòÏó¨ Ìñ•ÌõÑ ÌåÄ ÏóÖÎ¨¥Ïóê Ï†ÅÏö©ÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ Î¶¨ÎçîÎ°úÎ∂ÄÌÑ∞ ÏóÖÎ¨¥ ÏàòÌñâÏóê ÌïÑÏöîÌïú Í∂åÌïúÍ≥º Ï±ÖÏûÑÏùÑ ÏúÑÏûÑ Î∞õÏïÑ ÏùºÌïòÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÏóÖÎ¨¥ ÏàòÌñâÏóê ÎåÄÌï¥ ÏßÑÏ≤ôÎèÑ Í¥ÄÎ¶¨Î•º ÏßÄÏÜçÏ†ÅÏúºÎ°ú Î∞õÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÎÇ¥Ïô∏Î∂Ä Í≥†Í∞ùÎì§Ïùò ÏöîÍµ¨ÏÇ¨Ìï≠ ÎòêÎäî Î¨∏Ï†ú Î∞úÏÉùÏãú Ïã†ÏÜçÌïòÍ≤å ÌïÑÏöîÌïú ÎåÄÏïàÏùÑ ÎßàÎ†®ÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÌåÄ Î™©ÌëúÏôÄ Ïã§ÌñâÍ≥ÑÌöç ÏàòÎ¶Ω Í≥ºÏ†ïÏóê Ï∞∏Ïó¨ÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÎèôÎ£åÏùò ÏûÖÏû•Í≥º ÏÉÅÌô©ÏùÑ Í≥†Î†§Ìï¥ Ïó¥Î¶∞ ÏûêÏÑ∏Î°ú Îì§ÏúºÎ†§Í≥† ÎÖ∏Î†•ÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÌåÄÏõêÍ∞Ñ ÌîºÎìúÎ∞±ÏùÑ Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú ÏàòÏö©ÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÏÑúÎ°úÍ∞Ä Îß°Í≥† ÏûàÎäî ÏóÖÎ¨¥Ïùò Ïó≠Ìï†Í≥º Ï±ÖÏûÑÏùÑ Ïûò Ïù∏ÏãùÌïòÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÏóÖÏ†Å Î∞è Ïó≠Îüâ ÌèâÍ∞ÄÍ∞Ä Í≥µÏ†ïÌïòÎã§Í≥† ÏÉùÍ∞ÅÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ Í≥ºÏ†úÎ•º ÏàòÌñâ Ìï† Îïå ÏÇ¨Ï†Ñ Í≥ÑÌöç ÏàòÎ¶ΩÏù¥ÎÇò Ï†êÍ≤ÄÌïòÍ∏∞ Î≥¥Îã§Îäî Ïã†ÏÜçÌïòÍ≤å Ïã§ÌñâÌïòÎäî Í≤ÉÏóê Îçî ÌÅ∞ Í∞ÄÏπòÎ•º ÎëîÎã§,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ Í∞úÏù∏Ïùò Í≥ºÏ†ú Î™©Ìëú ÎπÑÏ†ÑÏù¥ ÌåÄÏùò Í≥ºÏ†ú Î™©Ìëú ÎπÑÏ†ÑÍ≥º Ïó∞Í≥ÑÎêòÏñ¥ ÏûàÎã§Í≥† ÎäêÎÅºÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÎèôÎ£åÏôÄ ÏùòÍ≤¨Ï∞®Ïù¥Í∞Ä Î∞úÏÉùÌï† Í≤ΩÏö∞ Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú Ìï¥Í≤∞Ï±ÖÏùÑ Î™®ÏÉâÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÏóÖÎ¨¥ÏóêÏÑú ÏòàÏ∏°ÎêòÎäî Î¶¨Ïä§ÌÅ¨ Î¨∏Ï†úÏ†ê Îì±ÏùÑ Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú Ï†úÏãúÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÌåÄ ÎÇ¥ ÏóÖÎ¨¥Î∂ÑÏû•Ïóê Î¨∏Ï†úÍ∞Ä Î∞úÏÉùÌï† Í≤ΩÏö∞ Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú Ìï¥Í≤∞Ï±ÖÏùÑ Î™®ÏÉâÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÏÑ±Í≥ºÏóê Îî∞Îùº Í≥µÏ†ïÌïòÍ≤å Î≥¥ÏÉÅÎ∞õÍ≥† ÏûàÎã§Í≥† ÎäêÎÇÄÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÎåÄÎÇ¥Ïô∏ ÌôòÍ≤ΩÏù¥ Î≥ÄÌï† Í≤ΩÏö∞ Í∏∞Ï°¥Ïùò Î™©ÌëúÏôÄ Ïã§ÌñâÍ≥ÑÌöçÏùÑ Ïú†Ïó∞ÌïòÍ≤å ÏàòÏ†ïÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÎèôÎ£åÏùò ÏóÖÎ¨¥ ÎÇ¥Ïö©Í≥º ÏßÑÌñâ ÏÉÅÌô©ÏùÑ ÌååÏïÖÌïòÍ≥† ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÎèôÎ£åÏôÄ Í¥ÄÍ≥Ñ Í∞àÎì±Ïù¥ Î∞úÏÉùÌïú Í≤ΩÏö∞ Ïù¥Î•º Ìï¥ÏÜåÌïòÍ∏∞ ÏúÑÌï¥ Ï†ÅÍ∑π ÎÖ∏Î†•ÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÌÉÄ ÌåÄÏõêÏùò Î¨∏Ï†úÎ•º Ìï¥Í≤∞Ìï† Ïàò ÏûàÎäî ÏïÑÏù¥ÎîîÏñ¥Î•º Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú Í∞úÏßÑÌïúÎã§.,Ïö∞Î¶¨ ÌåÄÏùò ÌïòÏúÑ ÌååÌä∏/Í∑∏Î£πÏùÄ ÌåÄ ÏÑ±Í≥ºÎã¨ÏÑ±ÏùÑ ÏßÄÏõêÌïòÎäîÎç∞ ÏûàÏñ¥ Ìö®Í≥ºÏ†ÅÏúºÎ°ú Íµ¨ÏÑ±ÎêòÏñ¥ ÏûàÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÏàòÌñâÍ≥ºÏ†ïÍ≥º ÏÑ±Í≥ºÏóê ÎåÄÌï¥ Ï†ÅÍ∑πÏ†ÅÏù∏ Ïπ≠Ï∞¨Í≥º Ïù∏Ï†ïÏùÑ Î∞õÍ≥† ÏûàÎã§Í≥† ÎäêÎÇÄÎã§.,Ïö∞Î¶¨ ÌåÄÏõêÎì§ÏùÄ ÏµúÏ¥àÏùò(ÌïúÎ≤à ÎÇ¥Î¶∞) ÌåêÎã®Ïù¥ÎÇò ÎåÄÏùëÏóê ÏñΩÎß§Ïù¥ÏßÄ ÏïäÍ≥† Î≥ÄÌôîÎêú ÏÉÅÌô©ÏùÑ Í∞úÎ∞©Ï†ÅÏúºÎ°ú ÏàòÏö©ÌïòÍ≥† Îã§Ïãú ÎåÄÏùëÌïúÎã§.
3,ÌåÄÏû•,4,4,4,3,4,4,4,4,4,3,4,3,4,4,4,4,4,4,4,3,3,4,3,3,3,3,4,4,3,4,3,4,3,4,3,4
1,ÌåÄÏõê,4,5,5,4,5,4,4,4,3,4,4,4,4,4,4,4,4,5,5,4,4,5,3,3,4,4,4,4,3,4,4,4,4,4,3,4
2,ÌåÄÏõê,4,5,4,4,5,4,5,5,4,4,4,4,5,4,5,5,4,5,4,5,5,5,4,5,5,5,5,5,4,4,4,4,5,4,5,4`;

            Papa.parse(sampleCsvData, {
                header: true,
                skipEmptyLines: true,
                complete: function(results) {
                    surveyData = results.data;
                    alert('ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Í∞Ä Î°úÎìúÎêòÏóàÏäµÎãàÎã§. Ïù¥Ï†ú Î¶¨Ìè¨Ìä∏Î•º ÏÉùÏÑ±Ìï† Ïàò ÏûàÏäµÎãàÎã§.');
                }
            });
        }

        // Î¶¨Ìè¨Ìä∏ ÏÉùÏÑ±
        function generateReport() {
            if (!surveyData) {
                alert('CSV Îç∞Ïù¥ÌÑ∞Î•º Î®ºÏ†Ä ÏóÖÎ°úÎìúÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            const companyName = document.getElementById('companyName').value;
            const teamName = document.getElementById('teamName').value;
            const reportDate = document.getElementById('reportDate').value;
            const totalMembers = document.getElementById('totalMembers').value;
            const leaderCount = document.getElementById('leaderCount').value;

            if (!companyName || !teamName || !reportDate || !totalMembers) {
                alert('ÌïÑÏàò Ï†ïÎ≥¥Î•º Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            // Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù
            const analysis = analyzeSurveyData(surveyData);
            
            // Î¶¨Ìè¨Ìä∏ HTML ÏÉùÏÑ±
            const reportHtml = generateReportHtml({
                companyName,
                teamName,
                reportDate,
                totalMembers: parseInt(totalMembers),
                leaderCount: parseInt(leaderCount),
                analysis,
                logo: companyLogo
            });

            document.getElementById('reportContent').innerHTML = reportHtml;
            
            // Ï∞®Ìä∏ ÏÉùÏÑ±
            setTimeout(() => {
                createCharts(analysis);
                document.getElementById('inputSection').style.display = 'none';
                document.getElementById('reportSection').style.display = 'block';
                document.querySelector('.report-content').style.display = 'block';
            }, 100);
        }

        // ÏÑ§Î¨∏ Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù
        function analyzeSurveyData(data) {
            const leaders = data.filter(row => row['Í∑ÄÌïòÏùò ÏßÅÏ±ÖÏùÑ ÏÑ†ÌÉùÌï¥ Ï£ºÏÑ∏Ïöî'] === 'ÌåÄÏû•');
            const members = data.filter(row => row['Í∑ÄÌïòÏùò ÏßÅÏ±ÖÏùÑ ÏÑ†ÌÉùÌï¥ Ï£ºÏÑ∏Ïöî'] === 'ÌåÄÏõê');
            
            const questions = [];
            for (let i = 1; i <= 36; i++) {
                const columnName = Object.keys(data[0]).find(key => 
                    key.includes('Ïö∞Î¶¨ ÌåÄ') && Object.keys(data[0]).indexOf(key) === i + 1
                );
                if (columnName) {
                    questions.push(columnName);
                }
            }

            // Í∞Å Î¨∏Ìï≠Î≥Ñ Ï†êÏàò Í≥ÑÏÇ∞
            const scores = {
                total: { all: 0, leader: 0, member: 0 },
                factors: {},
                questions: []
            };

            // Î¨∏Ìï≠Î≥Ñ Î∂ÑÏÑù
            questions.forEach((question, index) => {
                const allScores = data.map(row => parseFloat(row[question]) || 0).filter(score => score > 0);
                const leaderScores = leaders.map(row => parseFloat(row[question]) || 0).filter(score => score > 0);
                const memberScores = members.map(row => parseFloat(row[question]) || 0).filter(score => score > 0);

                const questionAnalysis = {
                    index: index + 1,
                    question: question.length > 50 ? question.substring(0, 50) + '...' : question,
                    fullQuestion: question,
                    all: allScores.length > 0 ? (allScores.reduce((a, b) => a + b, 0) / allScores.length) : 0,
                    leader: leaderScores.length > 0 ? (leaderScores.reduce((a, b
